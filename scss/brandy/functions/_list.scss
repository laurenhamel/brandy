////
/// @group brandy-lists
////

/// Retrieves the first item in a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @returns {mixed}
@function first( $list ){
    
  @return nth( $list, 1 );
  
}

/// Retrieves the last item in a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @returns {mixed}
@function last( $list ){
    
  @return nth( $list, length( $list ) );
  
}

/// Retrieves the last index of a value in a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {mixed} $value - Some value to be searched for
/// @returns {number} - Returns the index of the last occurrence of the value or `0` when not found
@function last-index( $list, $value ){
    
  @for $i from length($list) * -1 through -1 {
      
    @if( nth($list, abs($i)) == $value ){
          
      @return abs($i);
          
    }
      
  }
    
  @return 0;
  
}

/// Adds an item to the beginning of a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {mixed} $value - Some value to add to the beginning of the list
/// @returns {list}
@function prepend( $list, $value ){
    
  @return join( $value, $list );
  
}

/// Inserts a value at the nth index within a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {number} $index - The index where the value should be inserted
/// @param {mixed} $value - Some value to be inserted into the list
/// @returns {list}
@function insert-nth( $list, $index, $value ){
    
  $result: ();
    
  @for $i from 1 through length($list) {
        
    @if( $i == $index ){ $result: append( $result, $value ); }
        
    $result: append( $result, nth( $list, $i ) );
    
  }
    
  @return $result;
    
}

/// Replaces one or more occurrences of a value within a list with a new value
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {mixed} $old - The old value to be replaced
/// @param {mixed} $new - The new value to be inserted in place of the old value
/// @param {boolean} $recursive [false] - Determines whether only the first occurrence or all occurrences should be replaced
/// @returns {list}
@function replace( $list, $old, $new, $recursive: false ){
    
  $result: ();
    
  @for $i from 1 through length($list){
        
    @if( type-of( nth($list,$i) ) == list and $recursive ){
      
      $result: append($result, replace(nth($list,$i), $old, $new, $recursive));
    
    }
    
    @else {
           
      @if( nth($list, $i) == $old){ $result: append($result, $new); }
            
      @else { $result: append($result, nth($list,$i)); }
        
    }
    
  }
    
  @return $result;
    
}

/// Replaces a value at the nth index within a list
/// 
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {number} $index - The index where the value should be replaced
/// @param {mixed} $value - The value to be inserted in place of the old value
/// @returns {list}
@function replace-nth( $list, $index, $value ){
    
  $result: ();
  $index: if( $index < 0, length($list) + $index + 1, $index );
    
  @for $i from 1 through length($list){
    
    @if( $i == $index ){ $result: append( $result, $value ); }
    @else { $result: append( $result, nth($list, $i) ); }
    
  }
    
  @return $result;
    
}

/// Removes one or more occurrences of a value from a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {mixed} $value - Some value to be removed from the list
/// @param {boolean} $recurives [false] - Determines whether only the first occurrence or all occurrences should be removed
/// @returns {list}
@function remove( $list, $value, $recursive: false ){
    
  $result: ();
    
  @for $i from 1 through length($list){
        
    @if( type-of( nth($list,$i) ) == list and $recursive ){
      
      $result: append( $result, remove( nth($list,$i), $value, $recursive ) );
    
    }
    
    @else if( nth($list, $i) != $value ){
      
      $result: append( $result, nth($list,$i) );
        
    }
    
  }
    
  @return $result;
    
}

/// Rremoves a value at the nth index within a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {number} $index - The index where the value should be removed
/// @returns {list}
@function remove-nth( $list, $index ){
    
  $result: ();
  $index: if( $index < 0, length( $list ) + $index + 1, $index );
    
  @for $i from 1 through length($list){
        
    @if( $i != $index ){ $result: append( $result, nth($list,$i) ); }
    
  }
    
  @return $result;
    
}

/// Extracts a subset of a list between a starting and ending point
///
/// @author Hugo Giraudel
/// @requires {function} is-negative
/// @param {list} $list - Some list
/// @param {number} $start [1] - The starting index where the slice should begin
/// @param {number} $end [length($list)] - The ending index where the slice should stop
/// @returns {list}
/// @throws 'Cannot execute `slice` when start `#{$start}` exceeds end `#{$end}`.'
@function slice( $list, $start: 1, $end: length($list) ){
    
  $result: ();
  
  $s: $start;
  $e: $end;
  
  @if( is-negative($s) ) { $s: length($list) + $s; }
  @if( is-negative($e) ) { $e: length($list) + $e; }
  
  @if( $s > $e ) { 
    
    @warn 'Cannot execute `slice` when start `#{$start}` exceeds end `#{$end}`.';
      
    @return $list;
      
  }
    
  @for $i from $s through $e { $result: append( $result, nth($list, $i) ); }
    
  @return $result;
    
}

/// Reverses the order of items within a list
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {boolean} $recursive [false] - Determines whether nested lists should also be reversed
/// @returns {list}
@function reverse( $list, $recursive: false ){
    
  $result: ();
    
  @for $i from length($list) * -1 through -1 {
        
    @if( type-of( nth($list, abs($i)) ) == list and $recursive ){
            
      $result: append( $result, reverse(nth($list,abs($i)), $recursive) );
        
    }
        
    @else {
            
      $result: append( $result, nth($list, abs($i)) );
        
    }
    
  }
    
  @return $result;
    
}

/// Shuffles the order of items within a list
///
/// @param {list} $list - Some list
/// @param {boolean} $recursive [false] - Determines whether nested lists should also be shuffled
/// @returns {list}
@function shuffle( $list, $recursive: false ) {
  
  $result: $list;
  
  @for $i from length($list) * -1 through -1 {
    
    $n: floor(random($i + 1));
    
    $x: nth($result, $i);
    
    $result: set-nth($result, $i, nth($result, $n));
    
    $result: set-nth($result, $n, $x);
    
  }
  
  @return $result;
  
}

/// Glues a list together with a string to form a string
///
/// @author Hugo Giraudel
/// @param {list} $list - Some list
/// @param {string} $glue [''] - Acts as the glue between list items
/// @param {boolean} $nested [false] - Determines whether the list is part of a nested list, used for recursion
/// @returns {list}
@function glue( $list, $glue: '', $nested: false ){
    
  $result: null;
    
  @for $i from 1 through length($list) {
        
    $e: nth($list, $i);
        
    @if( type-of($e) == list ){ $result: $result + glue($e, $glue, true) ; }
    
    @else { $result: if( $i != length($list) or $nested, $result + $e + $glue, $result + $e ); }
        
  }
    
  @return $result;
    
}

/// Reindexes a list by the given value
///
/// @author Ana Tudor
/// @param {list} $list - Some list
/// @param {number} $value [1] - The number by which to shift the list indices
/// @returns {list}
@function shift-index( $list, $value: 1 ){
    
  $result: ();
    
  @for $i from 0 to length($list) { $result: append( $result, nth($list, ($i - $value) % length($list) + 1) ); }
    
  @return $result;
    
}

/// Determines whether or not the list contains the given value
///
/// @param {list} $list - Some list
/// @param {mixed} $search - The value to be searched for
/// @returns {boolean}
@function contains( $list, $search ) {
  
  $result: false;
  
  @each $item in $list {
    
    @if( $item == $search ) { $result: true; }
    
  }
  
  @return $result;
  
}

/// Determines whether or not the list starts with the given value
///
/// @requires {function} first
/// @param {list} $list - Some list
/// @param {mixed} $search - The value to be searched for
/// @returns {boolean}
@function starts-with( $list, $search ) {
  
  @return first($list) == $search;
  
}

/// Determines whether or not the list ends with the given value
///
/// @requires {function} last
/// @param {list} $list - Some list
/// @param {mixed} $search - The value to be searched for
/// @returns {boolean}
@function ends-with( $list, $search ) {
  
  @return last($list) == $search;
  
}

/// Chunks a list into subsets of the given size
///
/// @param {list} $list - Some list
/// @param {number} $length - The maximum length of chunked lists
/// @returns {list}
@function chunk( $list, $length ) {
  
  $result: ();
  $subset: ();
  
  @if( $length >= length($list) ) { @return $list; }
  
  $i: 1;
  $n: 1;
  
  @while( $i <= length($list) ) {
    
    @if( nth($list, $i) ) { $subset: append($subset, nth($list, $i)); }
    
    @if( $n == $length or $i == length($list) ) { 
      
      $result: append($result, $subset); 
      
      $subset: ();
      
      $n: 0;
      
    }
    
    $n: $n + 1;
    $i: $i + 1;
    
  }
  
  @return $result;
  
}

/// Counts the number of times a value occurs within a list
///
/// @requires {function} is-empty
/// @param {list} $list - Some list
/// @param {Arglist} $items - Filters the items to be counted
/// @returns {Map}
@function count( $list, $items...) {
  
  $result: ();
  
  @if( not is-empty($items) ) {
    
    @each $item in $items {
      
      $result: map-merge($result, ($item: 0));
      
    }
    
    @each $item in $list {
      
      @if( index($items, $item) != null ) {
        
        $result: map-merge($result, ($item: map-get($result, $item) + 1));
        
      }
      
    }
    
  }
  
  @else {
  
    @each $item in $list {

      $count: map-get($result, $item);

      $value: if($count, $count + 1, 1);

      $result: map-merge($result, ($item: $value));
        
    }
    
  }
  
  @return $result;
  
}

/// Tests if every item in the list meets some criteria presented by the `$test` function
///
/// @param {list} $list - Some list
/// @param {string} $test - The name of the function to be used as a test
/// @param {Arglist} $input - Any arguments to pass into the function
/// @returns {boolean}
@function every( $list, $test, $input... ) {
  
  @each $item in $list {
    
    @if ( not call(get-function($test), $item, $input...) ) {
      
      @return false;
      
    }
    
  }
  
  @return true;
  
}

/// Tests if some items in the list meet some criteria presented by the `$test` function
///
/// @param {list} $list - Some list
/// @param {string} $test - The name of the function to be used as a test
/// @param {Arglist} $input - Any arguments to pass into the function
/// @returns {boolean}
@function some( $list, $test, $input... ) {
  
  @each $item in $list {
    
    @if ( call(get-function($test), $item, $input...) ) {
      
      @return true;
      
    }
    
  }
  
  @return false;
  
}

/// Determines if a list is empty
///
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-empty( $list ) {
  
  @return length($list) == 0;
  
}

/// Determines if a list contains more than one item
///
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-multiple( $list ) {
  
  @return length($list) > 1;
  
}

/// Determines if a list contains only one item
///
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-single( $list ) {
  
  @return length($list) == 1;
  
}

/// Removes duplicate values from a list
///
/// @param {list} $list - Some list
/// @returns {list}
@function unique( $list ) {
  
  $result: ();
  
  @each $item in $list {
    
    @if( index($result, $item) == null ) {
      
      $result: append($result, $item);
      
    }
    
  }
  
  @return $result;
  
}

/// Determines if every value in a list is equal to `true`
///
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-truthy( $list ) {
  
  @each $item in $list {
    
    @if( $item != true ) { @return false }
    
  }
  
  @return true;
  
}

/// Determines if every value in a list is equal to `false`
///
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-falsy( $list ) {
  
  @each $item in $list {
    
    @if( $item != false ) { @return false }
    
  }
  
  @return true;
  
}

/// Pinpoints the intersection between two or more lists
///
/// @requires {function} unique
/// @param {list} $list - Some list to be used as a reference
/// @param {Arglist} $lists - Additional lists to be used for comparison
/// @returns {list}
@function intersection( $list, $lists... ) {
  
  $result: $list;
  
  @each $list in $lists {
    
    $intersect: ();
    
    @each $item in $result {
      
      @if( index($list, $item) != null ) {
        
        $intersect: append($intersect, $item, list-separator($list));
        
      }
      
    }
    
    $result: $intersect;
    
  }
  
  @return unique($result);
  
}

/// Determines whether a list is symmetrical
///
/// @requires {function} reverse
/// @param {list} $list - Some list
/// @returns {boolean}
@function is-symmetrical( $list ) {
  
  @return $list == reverse($list);
  
}

/// Removes empty values, such as `null`, `false`, and `()`, from a list
///
/// @param {list} $list - Some list
/// @returns {list}
@function scrub( $list ) {
  
  $result: ();
  
  @each $item in $list {
    
    @if( $item != false or $item != () or $item != null ) {
      
      $result: append($result, $item);
      
    }
    
  }
  
  @return $result;
  
}

/// Retrieves a random item from a list
///
/// @requires {function} is-empty
/// @param {list} $list - Some list
/// @returns {mixed}
/// @throws 'Cannot return a random value from an empty list.'. 
@function chance( $list ) {
  
  @if( is-empty($list) ) { 
  
    @warn 'Cannot return a random value from an empty list.';
    
    @return null;
  
  }
  
  @return nth($list, random(length($list) - 1) + 1);
  
}

/// Builds a list with values ranging from 1 through `$n`
///
/// @requires {function} str-is-number
/// @requires {function} strip-unit
/// @param {number} $n - Maximum index
/// @returns {list}
/// @throws 'Cannot create range from invalid number `#{$n}`.'
/// @throws 'Cannot create range from negative number `#{$n}`.'
@function range( $n ) {
  
  $result: ();
  
  @if( not str-is-numeric('#{$n}') ) {
    
    @warn 'Cannot create range from invalid number `#{$n}`.';
    
  }
  
  @else if( $n < 1 ) {
    
    @warn 'Cannot create range from negative number `#{$n}`.';
    
  }
  
  @else {
  
    @for $i from 1 through strip-unit($n) {
      
      $result: append($result, $i);
      
    }
    
  }
  
  @return $result;
  
}

/// Builds a list with values ranging from `$min` through `$max`
///
/// @requires {function} str-is-number
/// @requires {function} extract-unit
/// @requires {function} strip-unit
/// @requires {function} unit-to-digit
/// @param {number} $min - Minimum value
/// @param {number} $max - Maximum value
/// @returns {list}
/// @throws 'Cannot create range from invalid minimum `#{$min}`.'
/// @throws 'Cannot create range from invalid maximum `#{$max}`.'
@function range-min-max( $min, $max ) {
  
  $result: ();
  
  @if( not str-is-numeric('#{$min}') ) {
    
    @warn 'Cannot create range from invalid minimum `#{$min}`.';
    
  }
  
  @else if( not str-is-numeric('#{$max}') ) {
    
    @warn 'Cannot create range from invalid maximum `#{$max}`.';
    
  }
  
  @else {
    
    $inverted: if( strip-unit($max) >= strip-unit($min), false, true );
    
    $unit: unit-to-digit(extract-unit($min));
    
    @if( not $inverted ) {
  
      @for $i from strip-unit($min) through strip-unit($max) {

        $result: append($result, $i * $unit);

      }
      
    }
    
    @else {
      
      @for $i from strip-unit($max) through strip-unit($min) {
        
        $result: append($result, $i * $unit);
        
      }
      
    }
    
  }
  
  @return $result;
  
}

/// Builds a list with values ranging from a through `$x`
///
/// @requires {function} str-is-letter
/// @requires {function} cast-string
/// @requires {variable} $brandy-letters
/// @param {string} $x - Maximum index
/// @param {boolean} $lowercase [true] - Whether the result should be lowercase or uppercase
/// @returns {list}
/// @throws 'Cannot create range from invalid letter `#{$x}`.'
@function range-alpha( $x, $lowercase: true ) {
  
  $result: ();
  
  $insensitive-x: to-lower-case(cast-string($x));
  
  @if( not str-is-letter($insensitive-x) ) {
    
    @warn 'Cannot create range from invalid letter `#{$x}`.';
    
  }
  
  @else {
    
    $index: index(map-keys($brandy-letters), $insensitive-x);
  
    @for $n from 1 through $index {
      
      $letter: nth(map-keys($brandy-letters), $n);
      
      $result: append($result, if($lowercase, $letter, to-upper-case($letter)));
      
    }
    
  }
  
  @return $result;
  
}

/// Builds a list with letters ranging from `$min` through `$max`
///
/// @requires {function} str-is-letter
/// @requires {function} cast-string
/// @requires {variable} $brandy-letters
/// @param {string} $min - Minimum value
/// @param {string} $max - Maximum value
/// @param {boolean} $lowercase [true] - Whether the result should be lowercase or uppercase
/// @returns {list}
/// @throws 'Cannot create range from invalid minimum `#{$min}`.'
/// @throws 'Cannot create range from invalid maximum `#{$max}`.'
@function range-alpha-min-max( $min, $max, $lowercase: true ) {
  
  $result: ();
  
  $insensitive-min: to-lower-case(cast-string($min));
  $insensitive-max: to-lower-case(cast-string($max));
  
  @if( not str-is-letter($insensitive-min) ) {
    
    @warn 'Cannot create range from invalid minimum `#{$min}`.';
    
  }
  
  @else if( not str-is-letter($insensitive-max) ) {
    
    @warn 'Cannot create range from invalid maximum `#{$max}`.';
    
  }
  
  @else {
    
    $mindex: index(map-keys($brandy-letters), $insensitive-min);
    $maxdex: index(map-keys($brandy-letters), $insensitive-max);
    
    $inverted: if( $maxdex >= $mindex, false, true );
    
    @if( not $inverted ) {
  
      @for $n from $mindex through $maxdex {
        
        $letter: nth($letters, $n); 

        $result: append($result, if($lowercase, $letter, to-upper-case($letter)));

      }
      
    }
    
    @else {
      
      @for $n from $maxdex through $mindex {
        
        $letter: nth($letters, $n);
        
        $result: append($result, if($lowercase, $letter, to-upper-case($letter)));
        
      }
      
    }
    
  }
  
  @return $result;
  
}

/// Converts every item in a list to a string
///
/// @requires {function} cast-string
/// @param {list} $list
/// @returns {list}
@function stringify( $list ) {
  
  $result: ();
  
  @each $item in $list {
    
    $result: append($result, cast-string($item), list-separator($list));
    
  }
  
  @return $result;
  
}

/// Sums all numeric values in a list, ignoring non-numeric values
///
/// @requires {function} str-is-number
/// @requires {function} stringify
/// @requires {function} cast-number
/// @requires {function} cast-string
/// @requires {function} every
/// @requires {function} strip-unit
/// @requires {function} extract-unit
/// @param {list} $list - Some list containing numeric values
/// @param {boolean} $ignorant [false] - Determines whether units should be ignored and subsequently stripped
/// @returns {number} - Returns sum of all numeric values or `0` otherwise
/// @throws 'Some list items are non-numeric for `sum`.'
@function sum( $list, $ignorant: false ) {
  
  $result: 0;
  
  @each $item in $list {
    
    $stringified: append($stringified, '#{$item}');
    
  }
  
  @if( not every(stringify($list), 'str-is-number') ) {
    
    @warn 'Some list items are non-numeric for `sum`.';
    
  }
  
  $units: null;
  
  @each $item in $list {
    
    @if( str-is-number(cast-string($item)) ) {
      
      @if( type-of($item) == 'string' ) { $item: cast-number($item); }
      
      @if( $ignorant ) {
        
        $result: $result + strip-unit($item);
        
      }
      
      @else {
        
        $unit: extract-unit( $item );
        
        @if( $units == null ) { $units: $unit; }
        
        @if( $unit == $units ) {
          
          $result: $result + $item;
          
        }
        
      }
      
    }
    
  }
  
  @return $result;
  
}

/// Sorts a list
///
/// @requires {function} insert-nth
/// @param {list} $list - Some list to be sorted
/// @returns {list}
@function sort( $list ) {
  
  $result: ();
  
  $index: 1;
  
  @while( length($result) < length($list) ) {
    
    $item: nth($list, $index);
    
    $n: 1;
    
    @for $i from 1 through length($result) {
      
      $comp: nth($result, $i);
      
      @if( $comp < $item ) { $n: $i; }
      
    }
    
    $result: insert-nth($result, $n, $item);
    
    $index: $index + 1;
    
  }
  
  @return $result;
  
}

/// Applies a function to every item within the list
///
/// @param {list} $list - Some list
/// @returns {list}
/// @throws 'function `#{$function}` does not exist for `walk`.';
@function walk( $list, $function, $inputs... ) {
  
  @if( not function-exists($function) ) {
    
    @warn 'function `#{$function}` does not exist for `walk`.';
    @return $list;
    
  }
  
  $result: ();
  
  @each $item in $list {
    
    $result: append($result, call(get-function($function), $inputs...), list-separator($list));
    
  }
  
  @return $result;
  
}

/// Retrieves all items from a list except for the last
///
/// @requires {function} slice
/// @param {list} $list - Some list
/// @returns {list}
@function head( $list ) {
  
  @return slice($list, 1, -1);
  
}

/// Retrieves all items from a list except for the first
///
/// @requires {function} slice
/// @param {list} $list - Some list
/// @returns {list}
@function tail( $list ) {
  
  @return slice($list, 2);
  
}